{
    "system_prompt": "You are an assistant with expert knowledge about software and hardware vulnerabilities and the associated terminologies. Your task is to extract relevant information in a JSON format from a given vulnerability document. For a required field, if multiple parts of the document fits as an entry for the field, please include all separated by a semicolon i.e. ';'. If the information for a field is not present in the document, please leave it empty. Given below is an XML template that describes the information to extract from the vulnerability document and the attribute names to extract it into:\n\n{xml_template}\n\nONLY return a valid JSON object (no other text is necessary), where the key of the field in JSON is the `name` attribute of the corresponding XML, and the value is of the type specified by the corresponding XML's tag. The JSON MUST conform to the XML format, including any types and format requests e.g. requests for lists, objects and specific types.\n\nHere are examples of simple (XML, JSON) pairs that show the expected behavior:\n- `<string name='foo' format='two-words lower-case' />` => `{{'foo': 'example one'}}`\n- `<list name='bar'><string format='upper-case' /></list>` => `{{\"bar\": ['STRING ONE', 'STRING TWO', etc.]}}`\n- `<object name='baz'><string name=\"foo\" format=\"capitalize two-words\" /><integer name=\"index\" format=\"1-indexed\" /></object>` => `{{'baz': {{'foo': 'Some String', 'index': 1}}}}`\n\nReturn the extracted JSON within a code block enclosed between ```json ```. Be correct and concise.",
    "samples": [
        {
            "document": "A vulnerability in the web UI feature of Cisco IOS XE Software could allow an authenticated, remote attacker to inject commands with the privileges of root. This vulnerability is due to insufficient input validation. An attacker could exploit this vulnerability by sending crafted input to the web UI. A successful exploit could allow the attacker to inject commands to the underlying operating system with root privileges.",
            "extraction": {
                "vendor": "Cisco",                   
                "affected": [                   
                    {
                        "software": "IOS XE",
                        "softwareVersion": "",
                        "hardware": "",         
                        "hardwareVersion": ""   
                    }
                ],
                "weakness": "",                 
                "attackerPrivileges": "authenticated, remote attacker",
                "attackVector": "by sending crafted input to the web UI",
                "impact": "inject commands with the privileges of root",                   
                "vulnerableFunction": "",       
                "vulnerablePath": "",           
                "vulnerableParameters": "",     
                "vulnerableComponent": "web UI feature",      
                "rootCause": "insufficient input validation",                
                "remediation": "",              
                "patchInformation": ""
            }
        },
        {
            "document": "Skype for Business Elevation of Privilege Vulnerability",
            "extraction": {
                "vendor": "",
                "affected": [
                    {
                        "software": "Skype for Business",
                        "softwareVersion": "",
                        "hardware": "",
                        "hardwareVersion": ""
                    }
                ],
                "weakness": "Elevation of Privilege",
                "attackerPriviliges": "",
                "attackVector": "",
                "impact": "Elevation of Privilege",
                "vulnerableFunction": "",
                "vulnerablePath": "",
                "vulnerableParameters": "",
                "vulnerableComponent": "",
                "rootCause": "",
                "remediation": "",
                "patchInformation": ""
            }
        },
        {
            "document": "The HTTP/2 protocol allows a denial of service (server resource consumption) because request cancellation can reset many streams quickly, as exploited in the wild in August through October 2023.",
            "extraction": {
                "vendor": "",
                "affected": [
                    {
                        "software": "HTTP/2 protocol",
                        "softwareVersion": "",
                        "hardware": "",
                        "hardwareVersion": ""
                    }
                ],
                "weakness": "Denial of Service",
                "attackerPriviliges": "unauthenticated",
                "attackVector": "request cancellation leading to quick stream resets",
                "impact": "server resource consumption (denial of service)",
                "vulnerableFunction": "",
                "vulnerablePath": "",
                "vulnerableParameters": "",
                "vulnerableComponent": "",
                "rootCause": "The protocol's handling of request cancellation allows for quick stream resets",
                "remediation": "",
                "patchInformation": ""
            }
        },
        {
            "document": "In WS_FTP Server versions prior to 8.7.4 and 8.8.2, a pre-authenticated attacker could leverage a .NET deserialization vulnerability in the Ad Hoc Transfer module to execute remote commands on the underlying WS_FTP Server operating system.",
            "extraction": {
                "vendor": "",
                "affected": [
                    {
                        "software": "WS_FTP Server",
                        "softwareVersion": "< 8.7.4",
                        "hardware": "",
                        "hardwareVersion": ""
                    },
                    {
                        "software": "WS_FTP Server",
                        "softwareVersion": "< 8.8.2",
                        "hardware": "",
                        "hardwareVersion": ""
                    }
                ],
                "weakness": ".NET deserialization vulnerability",
                "attackerPriviliges": "pre-authenticated",
                "attackVector": "Leveraging the vulnerability in the Ad Hoc Transfer module",
                "impact": "execute remote commands on the underlying WS_FTP Server operating system",
                "vulnerableFunction": "",
                "vulnerablePath": "",
                "vulnerableParameters": "",
                "vulnerableComponent": "Ad Hoc Transfer module",
                "rootCause": ".NET deserialization vulnerability",
                "remediation": "",
                "patchInformation": ""
            }
        },
        {
            "document": "The issue was addressed with improved checks. This issue is fixed in Safari 17, iOS 16.7 and iPadOS 16.7, macOS Sonoma 14. Processing web content may lead to arbitrary code execution. Apple is aware of a report that this issue may have been actively exploited against versions of iOS before iOS 16.7.",
            "extraction": {
                "vendor": "",
                "affected": [
                    {
                        "software": "Safari",
                        "softwareVersion": "< 17",
                        "hardware": "",
                        "hardwareVersion": ""
                    },
                    {
                        "software": "iOS",
                        "softwareVersion": "< 16.7",
                        "hardware": "",
                        "hardwareVersion": ""
                    },
                    {
                        "software": "iPadOS",
                        "softwareVersion": "< 16.7",
                        "hardware": "",
                        "hardwareVersion": ""
                    },
                    {
                        "software": "macOS Sonoma",
                        "softwareVersion": "< 14",
                        "hardware": "",
                        "hardwareVersion": ""
                    }
                ],
                "weakness": "",
                "attackerPriviliges": "",
                "attackVector": "",
                "impact": "arbitrary code execution",
                "vulnerableFunction": "",
                "vulnerablePath": "",
                "vulnerableParameters": "",
                "vulnerableComponent": "Web content processing",
                "rootCause": "",
                "remediation": "Improved checks",
                "patchInformation": ""
            }
        },
        {
            "document": "Tenda W18E V16.01.0.8(1576) has a command injection vulnerability via the hostName parameter in the formSetNetCheckTools function.",
            "extraction": {
                "vendor": "Tenda",
                "affected": [
                    {
                        "software": "",
                        "softwareVersion": "V16.01.0.8(1576)",
                        "hardware": "W18E",
                        "hardwareVersion": ""
                    }
                ],
                "weakness": "command injection vulnerability",
                "attackerPriviliges": "",
                "attackVector": "",
                "impact": "command injection",
                "vulnerableFunction": "formSetNetCheckTools",
                "vulnerablePath": "",
                "vulnerableParameters": "hostName",
                "vulnerableComponent": "",
                "rootCause": "",
                "remediation": "",
                "patchInformation": ""
            }
        },
        {
            "document": "Tenda AC9 V3.0BR_V15.03.06.42_multi_TD01 was discovered stack overflow via parameter 'firewall_value' at url /goform/SetFirewallCfg.",
            "extraction": {
                "vendor": "Tenda",
                "affected": [
                    {
                        "software": "",
                        "softwareVersion": "V3.0BR_V15.03.06.42_multi_TD01",
                        "hardware": "AC9",
                        "hardwareVersion": ""
                    }
                ],
                "weakness": "stack overflow",
                "attackerPriviliges": "",
                "attackVector": "",
                "impact": "",
                "vulnerableFunction": "",
                "vulnerablePath": "/goform/SetFirewallCfg",
                "vulnerableParameters": "firewall_value",
                "vulnerableComponent": "",
                "rootCause": "",
                "remediation": "",
                "patchInformation": ""
            }
        },
        {
            "document": "An exploitable firmware modification vulnerability was discovered in certain Netgear products. The data integrity of the uploaded firmware image is ensured with a fixed checksum number. Therefore, an attacker can conduct a MITM attack to modify the user-uploaded firmware image and bypass the checksum verification. This affects WNR612v2 Wireless Routers 1.0.0.3 and earlier, DGN1000v3 Modem Router 1.0.0.22 and earlier, D6100 WiFi DSL Modem Routers 1.0.0.63 and earlier, WNR1000v2 Wireless Routers 1.1.2.60 and earlier, XAVN2001v2 Wireless-N Extenders 0.4.0.7 and earlier, WNR2200 Wireless Routers 1.0.1.102 and earlier, WNR2500 Wireless Routers 1.0.0.34 and earlier, R8900 Smart WiFi Routers 1.0.3.6 and earlier, and R9000 Smart WiFi Routers 1.0.3.6 and earlier.",
            "extraction": {
                "vendor": "Netgear",
                "affected": [
                    {
                        "software": "",
                        "softwareVersion": "1.0.0.3 and earlier",
                        "hardware": "WNR612v2 Wireless Routers",
                        "hardwareVersion": ""
                    },
                    {
                        "software": "",
                        "softwareVersion": "1.0.0.22 and earlier",
                        "hardware": "DGN1000v3 Modem Router",
                        "hardwareVersion": ""
                    },
                    {
                        "software": "",
                        "softwareVersion": "1.0.0.63 and earlier",
                        "hardware": "D6100 WiFi DSL Modem Routers",
                        "hardwareVersion": ""
                    },
                    {
                        "software": "",
                        "softwareVersion": "1.1.2.60 and earlier",
                        "hardware": "WNR1000v2 Wireless Routers",
                        "hardwareVersion": ""
                    },
                    {
                        "software": "",
                        "softwareVersion": "0.4.0.7 and earlier",
                        "hardware": "XAVN2001v2 Wireless-N Extenders",
                        "hardwareVersion": ""
                    },
                    {
                        "software": "",
                        "softwareVersion": "1.0.1.102 and earlier",
                        "hardware": "WNR2200 Wireless Routers",
                        "hardwareVersion": ""
                    },
                    {
                        "software": "",
                        "softwareVersion": "1.0.0.34 and earlier",
                        "hardware": "WNR2500 Wireless Routers",
                        "hardwareVersion": ""
                    },
                    {
                        "software": "",
                        "softwareVersion": "1.0.3.6 and earlier",
                        "hardware": "R8900 Smart WiFi Routers",
                        "hardwareVersion": ""
                    },
                    {
                        "software": "",
                        "softwareVersion": "1.0.3.6 and earlier",
                        "hardware": "R9000 Smart WiFi Routers",
                        "hardwareVersion": ""
                    }
                ],
                "weakness": "firmware modification vulnerability",
                "attackerPriviliges": "MITM",
                "attackVector": "an attacker can conduct a MITM attack to modify the user-uploaded firmware image and bypass the checksum verification",
                "impact": "data integrity of the firmware image",
                "vulnerableFunction": "",
                "vulnerablePath": "",
                "vulnerableParameters": "",
                "vulnerableComponent": "firmware integrity check",
                "rootCause": "fixed checksum number",
                "remediation": "",
                "patchInformation": ""
            }
        },
        {
            "document": "Cisco is aware of active exploitation of a previously unknown vulnerability in the web UI feature of Cisco IOS XE Software when exposed to the internet or to untrusted networks. This vulnerability allows a remote, unauthenticated attacker to create an account on an affected system with privilege level 15 access. The attacker can then use that account to gain control of the affected system. For steps to close the attack vector for this vulnerability, see the Recommendations section of this advisory  Cisco will provide updates on the status of this investigation and when a software patch is available.",
            "extraction": {
                "vendor": "Cisco",
                "affected": [
                    {
                        "software": "Cisco IOS XE Software",
                        "softwareVersion": "",
                        "hardware": "",
                        "hardwareVersion": ""
                    }
                ],
                "weakness": "",
                "attackerPriviliges": "remote, unauthenticated",
                "attackVector": "create an account on an affected system with privilege level 15 access",
                "impact": "create an account on an affected system with privilege level 15 access, gain control of the affected system",
                "vulnerableFunction": "",
                "vulnerablePath": "",
                "vulnerableParameters": "",
                "vulnerableComponent": "web UI feature",
                "rootCause": "",
                "remediation": "See the Recommendations section of the advisory",
                "patchInformation": "Cisco will provide updates on the status of this investigation and when a software patch is available."
            }
        },
        {
            "document": "Heap buffer overflow in vp8 encoding in libvpx in Google Chrome prior to 117.0.5938.132 and libvpx 1.13.1 allowed a remote attacker to potentially exploit heap corruption via a crafted HTML page. (Chromium security severity: High)",
            "extraction": {
                "vendor": "Google",
                "affected": [
                    {
                        "software": "Google Chrome",
                        "softwareVersion": "prior to 117.0.5938.132",
                        "hardware": "",
                        "hardwareVersion": ""
                    },
                    {
                        "software": "libvpx",
                        "softwareVersion": "1.13.1",
                        "hardware": "",
                        "hardwareVersion": ""
                    }
                ],
                "weakness": "Heap buffer overflow",
                "attackerPriviliges": "remote",
                "attackVector": "crafted HTML page",
                "impact": "potentially exploit heap corruption",
                "vulnerableFunction": "vp8 encoding",
                "vulnerablePath": "",
                "vulnerableParameters": "",
                "vulnerableComponent": "libvpx",
                "rootCause": "",
                "remediation": "",
                "patchInformation": ""
            }
        },
        {
            "document": "The pre-authentication command injection vulnerability in the Zyxel NAS326 firmware versions prior to V5.21(AAZF.14)C0, NAS540 firmware versions prior to V5.21(AATB.11)C0, and NAS542 firmware versions prior to V5.21(ABAG.11)C0 could allow an unauthenticated attacker to execute some operating system (OS) commands remotely by sending a crafted HTTP request.",
            "extraction": {
                "vendor": "Zyxel",
                "affected": [
                    {
                        "software": "NAS326 firmware",
                        "softwareVersion": "prior to V5.21(AAZF.14)C0",
                        "hardware": "Zyxel NAS326",
                        "hardwareVersion": ""
                    },
                    {
                        "software": "NAS540 firmware",
                        "softwareVersion": "prior to V5.21(AATB.11)C0",
                        "hardware": "Zyxel NAS540",
                        "hardwareVersion": ""
                    },
                    {
                        "software": "NAS542 firmware",
                        "softwareVersion": "prior to V5.21(ABAG.11)C0",
                        "hardware": "Zyxel NAS542",
                        "hardwareVersion": ""
                    }
                ],
                "weakness": "command injection",
                "attackerPriviliges": "unauthenticated",
                "attackVector": "crafted HTTP request",
                "impact": "execute some operating system (OS) commands remotely",
                "vulnerableFunction": "",
                "vulnerablePath": "",
                "vulnerableParameters": "",
                "vulnerableComponent": "",
                "rootCause": "",
                "remediation": "",
                "patchInformation": ""
            }
        },
        {
            "document": "A remote command injection vulnerability exists in the Barracuda Email Security Gateway (appliance form factor only) product effecting versions 5.1.3.001-9.2.0.006. The vulnerability arises out of a failure to comprehensively sanitize the processing of .tar file (tape archives). The vulnerability stems from incomplete input validation of a user-supplied .tar file as it pertains to the names of the files contained within the archive. As a consequence, a remote attacker can specifically format these file names in a particular manner that will result in remotely executing a system command through Perl's qx operator with the privileges of the Email Security Gateway product. This issue was fixed as part of BNSF-36456 patch. This patch was automatically applied to all customer appliances.",
            "extraction": {
                "vendor": "Barracuda",
                "affected": [
                    {
                        "software": "Email Security Gateway",
                        "softwareVersion": "5.1.3.001-9.2.0.006",
                        "hardware": "Barracuda Email Security Gateway (appliance form factor only)",
                        "hardwareVersion": ""
                    }
                ],
                "weakness": "remote command injection",
                "attackerPriviliges": "remote",
                "attackVector": "a remote attacker can specifically format these file names in a particular manner",
                "impact": "remotely executing a system command through Perl's qx operator with the privileges of the Email Security Gateway product",
                "vulnerableFunction": "",
                "vulnerablePath": "",
                "vulnerableParameters": ".tar file",
                "vulnerableComponent": "Email Security Gateway",
                "rootCause": "failure to comprehensively sanitize the processing of .tar file; incomplete input validation of a user-supplied .tar file as it pertains to the names of the files contained within the archive",
                "remediation": "BNSF-36456 patch",
                "patchInformation": "This issue was fixed as part of BNSF-36456 patch. This patch was automatically applied to all customer appliances."
            }
        },
        {
            "document": "For RocketMQ versions 5.1.0 and below, under certain conditions, there is a risk of remote command execution.  Several components of RocketMQ, including NameServer, Broker, and Controller, are leaked on the extranet and lack permission verification, an attacker can exploit this vulnerability by using the update configuration function to execute commands as the system users that RocketMQ is running as. Additionally, an attacker can achieve the same effect by forging the RocketMQ protocol content.  To prevent these attacks, users are recommended to upgrade to version 5.1.1 or above for using RocketMQ 5.x or 4.9.6 or above for using RocketMQ 4.x .",
            "extraction": {
                "vendor": "RocketMQ",
                "affected": [
                    {
                        "software": "RocketMQ",
                        "softwareVersion": "5.1.0 and below",
                        "hardware": "",
                        "hardwareVersion": ""
                    },
                    {
                        "software": "RocketMQ",
                        "softwareVersion": "4.x (versions below 4.9.6)",
                        "hardware": "",
                        "hardwareVersion": ""
                    }
                ],
                "weakness": "remote command execution",
                "attackerPriviliges": "",
                "attackVector": "exploiting the update configuration function; forging the RocketMQ protocol content",
                "impact": "execute commands as the system users that RocketMQ is running as",
                "vulnerableFunction": "update configuration function",
                "vulnerablePath": "",
                "vulnerableParameters": "",
                "vulnerableComponent": "Several components including NameServer, Broker, and Controller",
                "rootCause": "components leaked on the extranet and lack of permission verification",
                "remediation": "upgrade to version 5.1.1 or above for RocketMQ 5.x or 4.9.6 or above for RocketMQ 4.x",
                "patchInformation": "users are recommended to upgrade to version 5.1.1 or above for using RocketMQ 5.x or 4.9.6 or above for using RocketMQ 4.x"
            }
        },
        {
            "document": "Kernel pointers are printed in the log file prior to SMR May-2023 Release 1 allows a privileged local attacker to bypass ASLR.",
            "extraction": {
                "vendor": "",
                "affected": [
                    {
                        "software": "Kernel",
                        "softwareVersion": "prior to SMR May-2023 Release 1",
                        "hardware": "",
                        "hardwareVersion": ""
                    }
                ],
                "weakness": "",
                "attackerPriviliges": "privileged local attacker",
                "attackVector": "log file",
                "impact": "bypass ASLR",
                "vulnerableFunction": "",
                "vulnerablePath": "",
                "vulnerableParameters": "",
                "vulnerableComponent": "Kernel",
                "rootCause": "Kernel pointers are printed in the log file",
                "remediation": "",
                "patchInformation": "SMR May-2023 Release 1"
            }
        },
        {
            "document": "This vulnerability allows remote attackers to bypass authentication on affected installations of PaperCut NG 22.0.5 (Build 63914). Authentication is not required to exploit this vulnerability. The specific flaw exists within the SetupCompleted class. The issue results from improper access control. An attacker can leverage this vulnerability to bypass authentication and execute arbitrary code in the context of SYSTEM. Was ZDI-CAN-18987.",
            "extraction": {
                "vendor": "PaperCut",
                "affected": [
                    {
                        "software": "PaperCut NG",
                        "softwareVersion": "22.0.5 (Build 63914)",
                        "hardware": "",
                        "hardwareVersion": ""
                    }
                ],
                "weakness": "authentication bypass",
                "attackerPriviliges": "remote; Authentication is not required",
                "attackVector": "",
                "impact": "bypass authentication and execute arbitrary code in the context of SYSTEM",
                "vulnerableFunction": "SetupCompleted class",
                "vulnerablePath": "",
                "vulnerableParameters": "",
                "vulnerableComponent": "",
                "rootCause": "improper access control",
                "remediation": "",
                "patchInformation": ""
            }
        },
        {
            "document": "Memory leak vulnerability in Mali GPU Kernel Driver in Midgard GPU Kernel Driver all versions from r6p0 - r32p0, Bifrost GPU Kernel Driver all versions from r0p0 - r42p0, Valhall GPU Kernel Driver all versions from r19p0 - r42p0, and Avalon GPU Kernel Driver all versions from r41p0 - r42p0 allows a non-privileged user to make valid GPU processing operations that expose sensitive kernel metadata.",
            "extraction": {
                "vendor": "",
                "affected": [
                    {
                        "software": "Mali GPU Kernel Driver - Midgard",
                        "softwareVersion": "all versions from r6p0 - r32p0",
                        "hardware": "",
                        "hardwareVersion": ""
                    },
                    {
                        "software": "Mali GPU Kernel Driver - Bifrost",
                        "softwareVersion": "all versions from r0p0 - r42p0",
                        "hardware": "",
                        "hardwareVersion": ""
                    },
                    {
                        "software": "Mali GPU Kernel Driver - Valhall",
                        "softwareVersion": "all versions from r19p0 - r42p0",
                        "hardware": "",
                        "hardwareVersion": ""
                    },
                    {
                        "software": "Mali GPU Kernel Driver - Avalon",
                        "softwareVersion": "all versions from r41p0 - r42p0",
                        "hardware": "",
                        "hardwareVersion": ""
                    }
                ],
                "weakness": "memory leak",
                "attackerPriviliges": "non-privileged user",
                "attackVector": "valid GPU processing operations",
                "impact": "expose sensitive kernel metadata",
                "vulnerableFunction": "",
                "vulnerablePath": "",
                "vulnerableParameters": "",
                "vulnerableComponent": "",
                "rootCause": "",
                "remediation": "",
                "patchInformation": ""
            }
        },
        {
            "document": "In WorkSource, there is a possible parcel mismatch. This could lead to local escalation of privilege with no additional execution privileges needed. User interaction is not needed for exploitation.Product: AndroidVersions: Android-11 Android-12 Android-12L Android-13Android ID: A-220302519",
            "extraction": {
                "vendor": "Android",
                "affected": [
                    {
                        "software": "Android",
                        "softwareVersion": "Android-11",
                        "hardware": "",
                        "hardwareVersion": ""
                    },
                    {
                        "software": "Android",
                        "softwareVersion": "Android-12",
                        "hardware": "",
                        "hardwareVersion": ""
                    },
                    {
                        "software": "Android",
                        "softwareVersion": "Android-12L",
                        "hardware": "",
                        "hardwareVersion": ""
                    },
                    {
                        "software": "Android",
                        "softwareVersion": "Android-13",
                        "hardware": "",
                        "hardwareVersion": ""
                    }
                ],
                "weakness": "local escalation of privilege",
                "attackerPriviliges": "local; no additional execution privileges needed",
                "attackVector": "",
                "impact": "local escalation of privilege",
                "vulnerableFunction": "",
                "vulnerablePath": "",
                "vulnerableParameters": "",
                "vulnerableComponent": "WorkSource",
                "rootCause": "possible parcel mismatch",
                "remediation": "",
                "patchInformation": ""
            }
        },
        {
            "document": "TP-Link Archer AX21 (AX1800) firmware versions before 1.1.4 Build 20230219 contained a command injection vulnerability in the country form of the /cgi-bin/luci;stok=/locale endpoint on the web management interface. Specifically, the country parameter of the write operation was not sanitized before being used in a call to popen(), allowing an unauthenticated attacker to inject commands, which would be run as root, with a simple POST request.",
            "extraction": {
                "vendor": "TP-Link",
                "affected": [
                    {
                        "software": "Archer AX21 (AX1800) firmware",
                        "softwareVersion": "versions before 1.1.4 Build 20230219",
                        "hardware": "TP-Link Archer AX21 (AX1800)",
                        "hardwareVersion": ""
                    }
                ],
                "weakness": "command injection",
                "attackerPriviliges": "unauthenticated",
                "attackVector": "with a simple POST request",
                "impact": "inject commands, which would be run as root",
                "vulnerableFunction": "",
                "vulnerablePath": "/cgi-bin/luci;stok=/locale",
                "vulnerableParameters": "country parameter of the write operation",
                "vulnerableComponent": "web management interface",
                "rootCause": "country parameter was not sanitized before being used in a call to popen()",
                "remediation": "",
                "patchInformation": ""
            }
        },
        {
            "document": "Cacti is an open source platform which provides a robust and extensible operational monitoring and fault management framework for users. In affected versions a command injection vulnerability allows an unauthenticated user to execute arbitrary code on a server running Cacti, if a specific data source was selected for any monitored device. The vulnerability resides in the `remote_agent.php` file. This file can be accessed without authentication. This function retrieves the IP address of the client via `get_client_addr` and resolves this IP address to the corresponding hostname via `gethostbyaddr`. After this, it is verified that an entry within the `poller` table exists, where the hostname corresponds to the resolved hostname. If such an entry was found, the function returns `true` and the client is authorized. This authorization can be bypassed due to the implementation of the `get_client_addr` function. The function is defined in the file `lib/functions.php` and checks serval `$_SERVER` variables to determine the IP address of the client. The variables beginning with `HTTP_` can be arbitrarily set by an attacker. Since there is a default entry in the `poller` table with the hostname of the server running Cacti, an attacker can bypass the authentication e.g. by providing the header `Forwarded-For: <TARGETIP>`. This way the function `get_client_addr` returns the IP address of the server running Cacti. The following call to `gethostbyaddr` will resolve this IP address to the hostname of the server, which will pass the `poller` hostname check because of the default entry. After the authorization of the `remote_agent.php` file is bypassed, an attacker can trigger different actions. One of these actions is called `polldata`. The called function `poll_for_data` retrieves a few request parameters and loads the corresponding `poller_item` entries from the database. If the `action` of a `poller_item` equals `POLLER_ACTION_SCRIPT_PHP`, the function `proc_open` is used to execute a PHP script. The attacker-controlled parameter `$poller_id` is retrieved via the function `get_nfilter_request_var`, which allows arbitrary strings. This variable is later inserted into the string passed to `proc_open`, which leads to a command injection vulnerability. By e.g. providing the `poller_id=;id` the `id` command is executed. In order to reach the vulnerable call, the attacker must provide a `host_id` and `local_data_id`, where the `action` of the corresponding `poller_item` is set to `POLLER_ACTION_SCRIPT_PHP`. Both of these ids (`host_id` and `local_data_id`) can easily be bruteforced. The only requirement is that a `poller_item` with an `POLLER_ACTION_SCRIPT_PHP` action exists. This is very likely on a productive instance because this action is added by some predefined templates like `Device - Uptime` or `Device - Polling Time`. This command injection vulnerability allows an unauthenticated user to execute arbitrary commands if a `poller_item` with the `action` type `POLLER_ACTION_SCRIPT_PHP` (`2`) is configured. The authorization bypass should be prevented by not allowing an attacker to make `get_client_addr` (file `lib/functions.php`) return an arbitrary IP address. This could be done by not honoring the `HTTP_...` `$_SERVER` variables. If these should be kept for compatibility reasons it should at least be prevented to fake the IP address of the server running Cacti. This vulnerability has been addressed in both the 1.2.x and 1.3.x release branches with `1.2.23` being the first release containing the patch.",
            "extraction": {
                "vendor": "Cacti",
                "affected": [
                    {
                        "software": "Cacti",
                        "softwareVersion": "versions before 1.2.23",
                        "hardware": "",
                        "hardwareVersion": ""
                    }
                ],
                "weakness": "command injection",
                "attackerPriviliges": "unauthenticated",
                "attackVector": "remote_agent.php file",
                "impact": "execute arbitrary code on a server running Cacti",
                "vulnerableFunction": "get_client_addr; get_nfilter_request_var",
                "vulnerablePath": "remote_agent.php",
                "vulnerableParameters": "poller_id",
                "vulnerableComponent": "Cacti's monitoring functionality",
                "rootCause": "insufficient validation and sanitization of input, allowing bypassing of authorization and command execution",
                "remediation": "The authorization bypass should be prevented by not allowing an attacker to make `get_client_addr` (file `lib/functions.php`) return an arbitrary IP address. This could be done by not honoring the `HTTP_...` `$_SERVER` variables. If these should be kept for compatibility reasons it should at least be prevented to fake the IP address of the server running Cacti.",
                "patchInformation": "This vulnerability has been addressed in both the 1.2.x and 1.3.x release branches with 1.2.23 being the first release containing the patch."
            }
        }
    ]
}
